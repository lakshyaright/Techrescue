<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expert Dashboard - TechRescue</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
  <style>
    body {
      margin: 0;
      font-family: 'Inter', Arial, sans-serif;
      background: #f4f6f8;
      color: #333;
      display: flex;
      height: 100vh;
    }
    /* Sidebar */
    .sidebar {
      width: 240px;
      background: #fff;
      border-right: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      padding: 20px;
      box-sizing: border-box;
    }
    .sidebar h2 {
      font-size: 18px;
      margin-bottom: 30px;
      color: #0066cc;
    }
    .sidebar nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      flex: 1;
    }
    .sidebar nav li {
      margin-bottom: 20px;
    }
    .sidebar nav a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .sidebar nav a.active {
      color: #0066cc;
    }
    .sidebar .settings {
      margin-top: auto;
    }
    /* Main */
    .main {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .topbar {
      background: #0066cc;
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .topbar .right {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .topbar .avatar {
      background: #005bb5;
      border-radius: 50%;
      width: 35px;
      height: 35px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: bold;
      font-size: 14px;
    }
    .content {
      padding: 20px;
      overflow-y: auto;
    }
    .cards {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 8px;
      flex: 1;
      min-width: 220px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .card h3 {
      margin: 0 0 10px;
      font-size: 16px;
    }
    .card p {
      font-size: 24px;
      margin: 0;
      font-weight: 600;
    }
    .small {
      font-size: 12px;
      color: #555;
    }
    .performance, .alerts, .upcoming {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    .alerts .alert {
      background: #fff3cd;
      border: 1px solid #ffeeba;
      padding: 10px;
      border-radius: 4px;
      margin-bottom: 10px;
    }
    .alerts .alert h4 {
      margin: 0 0 5px;
      font-size: 14px;
    }
    .alerts .alert p {
      margin: 0 0 5px;
      font-size: 13px;
    }
    .alerts .actions button {
      padding: 5px 10px;
      margin-right: 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    .alerts .actions .ignore {
      background: #ccc;
      color: #333;
    }
    .alerts .actions .respond {
      background: #0066cc;
      color: white;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>TechRescue</h2>
    <nav>
      <ul>
        <li><a href="dashboard.html" class="active">Dashboard</a></li>
        <li><a href="alerts.html">Alerts <span style="color:red;">3</span></a></li>
        <li><a href="jobs.html">Jobs</a></li>
        <li><a href="messages.html">Messages</a></li>
        <li><a href="profile.html">Profile</a></li>
      </ul>
      <ul class="settings">
        <li><a href="#">Account Settings</a></li>
        <li><a href="#" onclick="logout()">Logout</a></li>
      </ul>
    </nav>
  </div>
  <!-- Main -->
  <div class="main">
    <!-- Topbar -->
    <div class="topbar">
      <div id="welcomeText">Welcome back...</div>
      <div class="right">
        <div>üîî <span style="color:yellow;">3</span></div>
          <div class="avatar" id="avatar">--</div>
          <div id="userName">Loading...</div>
      </div>
    </div>
<div style="padding:8px 20px; background:#eef4ff; border-bottom:1px solid #ddd;">
  <label style="cursor:pointer; font-weight:600;">
    <input type="checkbox" id="statusToggle" onchange="toggleStatus()" style="margin-right:6px;">
    <span id="statusText">Offline ‚ö´</span>
  </label>
</div>
    
    <!-- Content -->
    <div class="content">
      <div class="cards">
        <div class="card">
          <h3>Total Earnings</h3>
          <p>$1,240.00</p>
          <div class="small">+12.5% from last month</div>
        </div>
        <div class="card">
          <h3>Jobs Completed</h3>
          <p>24</p>
          <div class="small">+8.2% from last month</div>
        </div>
        <div class="card">
          <h3>Client Rating</h3>
          <p>4.9 / 5.0 ‚≠ê</p>
          <div class="small">+0.2 from last month</div>
        </div>
      </div>

      <div class="performance">
        <h3>Monthly Performance</h3>
        <p style="color:#999;">(Chart placeholder - integrate chart.js or similar)</p>
      </div>

      <div class="alerts">
        <h3>New Alerts</h3>
        <div class="alert">
          <h4>Network Troubleshooting</h4>
          <p>Need urgent network troubleshooting for small business. <br><small>30 mins ago</small></p>
          <div class="actions">
            <button class="ignore">Ignore</button>
            <button class="respond">Respond</button>
          </div>
        </div>
        <div class="alert">
          <h4>Office 365 Configuration</h4>
          <p>Help configuring Office 365 for new startup. <br><small>2 hours ago</small></p>
          <div class="actions">
            <button class="ignore">Ignore</button>
            <button class="respond">Respond</button>
          </div>
        </div>
      </div>

      <div class="upcoming">
        <h3>Upcoming Jobs</h3>
        <p>No jobs scheduled.</p>
      </div>
    </div>
  </div>
  <script>
const token = localStorage.getItem("token");

if(!token){
  window.location.href = "login.html";
}

// Fetch logged-in user
async function loadUser(){
  try {
    const res = await fetch("https://techrescue.onrender.com/me", {
      headers: {
        "Authorization": "Bearer " + token
      }
    });

    const user = await res.json();

    if(!res.ok){
      localStorage.removeItem("token");
      window.location.href = "login.html";
      return;
    }

    const fullName = (user.first_name || "") + " " + (user.last_name || "");
    const initials = (user.first_name?.[0] || "") + (user.last_name?.[0] || "");

    document.getElementById("welcomeText").innerText = "Welcome back, " + fullName;
    document.getElementById("userName").innerText = fullName + " (" + user.email + ")";
    document.getElementById("avatar").innerText = initials.toUpperCase();

  } catch(err){
    console.log(err);
    localStorage.removeItem("token");
    window.location.href = "login.html";
  }
}

loadUser();
</script>

  <script>
const token = localStorage.getItem("token");
if(!token) window.location.href="login.html";

/* =========================
   LOAD CURRENT STATUS
========================= */
async function loadMyStatus(){
  try{
    const res = await fetch("https://techrescue.onrender.com/me", {
      headers:{ "Authorization":"Bearer " + token }
    });

    const user = await res.json();

    if(user.online){
      document.getElementById("statusToggle").checked = true;
      document.getElementById("statusText").innerText = "Online üü¢";
    } else {
      document.getElementById("statusText").innerText = "Offline ‚ö´";
    }

  }catch(err){
    console.log(err);
  }
}
loadMyStatus();


/* =========================
   TOGGLE ONLINE / OFFLINE
========================= */
<script>
const token = localStorage.getItem("token");
if(!token) window.location.href="login.html";

/* Load current status */
async function loadMyStatus(){
  const res = await fetch("https://techrescue.onrender.com/me", {
    headers:{ "Authorization":"Bearer " + token }
  });

  const user = await res.json();

  if(user.online){
    document.getElementById("statusToggle").checked = true;
    document.getElementById("statusText").innerText = "Online üü¢";
  }
}
loadMyStatus();

/* Toggle Online/Offline */
async function toggleStatus(){
  const online = document.getElementById("statusToggle").checked;

  document.getElementById("statusText").innerText =
    online ? "Online üü¢" : "Offline ‚ö´";

  await fetch("https://techrescue.onrender.com/update-status", {
    method:"POST",
    headers:{
      "Content-Type":"application/json",
      "Authorization":"Bearer " + token
    },
    body: JSON.stringify({ online })
  });
}
</script>
  
</body>
</html>







