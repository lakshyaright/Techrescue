<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Engineer Signup - TechRescue</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

<div class="bg-white shadow-lg rounded-xl w-full max-w-lg p-8">

<h2 class="text-2xl font-bold text-center text-blue-600 mb-6">
Create Engineer Account
</h2>

<form id="signupForm" class="space-y-4">

<div class="grid grid-cols-2 gap-4">
<input type="text" id="firstName" placeholder="First Name" class="w-full border rounded-lg p-2" required>
<input type="text" id="lastName" placeholder="Last Name" class="w-full border rounded-lg p-2" required>
</div>

<input type="email" id="email" placeholder="Email ID" class="w-full border rounded-lg p-2" required>
<input type="password" id="password" placeholder="Password" class="w-full border rounded-lg p-2" required>

<select id="country" class="w-full border rounded-lg p-2" required>
<option value="">Select Country</option>
<option>India</option>
<option>USA</option>
<option>UK</option>
<option>Canada</option>
<option>Australia</option>
</select>

<select id="state" class="w-full border rounded-lg p-2" required>
<option value="">Select State</option>
<option>Uttar Pradesh</option>
<option>Delhi</option>
<option>Haryana</option>
<option>Maharashtra</option>
</select>

<button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700">
Create Account
</button>

</form>

<p id="message" class="text-center mt-4 font-semibold"></p>

</div>

<script>
document.getElementById("signupForm").addEventListener("submit", async function(e) {
    e.preventDefault();

    let messageBox = document.getElementById("message");

    const data = {
        first_name: document.getElementById("firstName").value,
        last_name: document.getElementById("lastName").value,
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
        country: document.getElementById("country").value,
        state: document.getElementById("state").value
    };

    try {
        const res = await fetch("https://techrescue.onrender.com/add-engineer", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        });

        const result = await res.json();

        /* EMAIL ALREADY EXISTS */
        if(result.status === "exists"){
            messageBox.innerHTML = `
                <span class="text-red-600">‚ö†Ô∏è Account already exists</span><br>
                <a href="reset-password.html?email=${data.email}" 
                   class="text-blue-600 underline">
                   Reset Password
                </a>
            `;
            return;
        }

        /* SUCCESS */
        if(result.status === "success"){
            messageBox.innerHTML =
                '<span class="text-green-600">üéâ Congratulations! Your account is created.</span>';

            setTimeout(()=>{
                window.location.href = "welcome-questions.html";
            },1500);
        }

        /* ERROR */
        if(result.status === "error"){
            messageBox.innerHTML =
                '<span class="text-red-600">‚ùå Registration failed</span>';
        }

    } catch (err) {
        messageBox.innerHTML =
            '<span class="text-red-600">‚ùå Server error</span>';
    }
});
</script>

</body>
</html>
